
target_default: 3_model_inputs

include:
  - 2_model_config.yml

packages:
  - yaml
  - whisker
  - dplyr
  - tidyr
  - meddle
  - readr
  - httr
  - rgdal
  - stringr
  - glmtools


sources:
  - src/spatial_utils.R
  - src/file_utils.R

targets:
  3_model_inputs:
    depends:
      - out/meteo_inputs.zip
      - out/mendota_meteo.csv
      - out/sparkling_meteo.csv


  out/mendota_meteo.csv:
    command: file.copy('../fig_1/yeti_sync/me_meteo.csv', to = target_name)

  out/sparkling_meteo.csv:
    command: file.copy('../fig_2/yeti_sync/sp_meteo.csv', to = target_name)

  out/meteo_inputs.zip:
    command: bundle_meteo_files(target_name, lake_ids, pattern = I('_meteo.csv'))

  inputs_text:
    command: yaml.load_file("in/text_drivers.yml")

  a68_inputs_text:
    command: >
      list(title = I('All lakes historical inputs: Process-guided deep learning predictions of lake water temperature'))

  sp_inputs_text:
    command: >
      list(title = I('Sparkling Lake detailed inputs: Process-guided deep learning predictions of lake water temperature'))

  me_inputs_text:
    command: >
      list(title = I('Lake Mendota detailed inputs: Process-guided deep learning predictions of lake water temperature'))

# update to use specific inputs_text
  out/68_inputs.xml:
    command: render(filename = target_name, generic_text, inputs_text, a68_inputs_text, spatial_metadata)

  # update to use specific inputs_text
  out/sp_inputs.xml:
    command: render(filename = target_name, generic_text, inputs_text, sp_inputs_text, spatial_metadata)

  # update to use specific inputs_text
  out/me_inputs.xml:
    command: render(filename = target_name, generic_text, inputs_text, me_inputs_text, me_spatial_metadata)
