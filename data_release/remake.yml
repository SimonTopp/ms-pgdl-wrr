
packages:
  - yaml
  - whisker
  - dplyr
  - tidyr
  - meddle
  - readr
  - httr
  - rgdal
  - sp

sources:
  - src/spatial_utils.R

targets:
  all:
    depends:
      - out/release.xml

  lake_ids:
    command: read_csv("in/model_lake_ids.csv")

  modeled_lakes:
    command: subset_save_winslow(lake_ids)

  in/model_lakes_attrs.csv:
    command: attribute_skeleton(modeled_lakes, attr.file = target_name)

  generic_text:
    command: yaml.load_file("in/text_SHARED.yml")

  release_text:
    command: yaml.load_file("in/text_release.yml")

  lakes_metadata:
    command: as.attr_list("in/model_lakes_attrs.csv")

  spatial_metadata:
    command: extract_feature(modeled_lakes)

  out/release.xml:
    command: render(filename = target_name, generic_text, release_text, lakes_metadata, spatial_metadata)
